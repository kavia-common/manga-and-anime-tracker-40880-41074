{"is_source_file": true, "format": "JavaScript (React JSX)", "description": "This file defines a React context provider (AppProvider) for managing global application state related to user sessions, ratings, lists, and sign-out logic in a manga and anime tracking app. It includes hooks, context, and utility functions for authentication, data persistence, and UI state management.", "external_files": ["../supabaseClient", "../services/catalog", "../services/supabaseData", "../components/Toast"], "external_methods": ["getSupabase", "getEnvWarning", "getCurrentSession", "RatingsService.loadAll", "ListsService.loadList", "ListsService.add", "ListsService.remove"], "published": ["AppContext", "useAppContext"], "classes": [], "methods": [{"name": "useAppContext", "description": "Custom hook to access the application context values."}, {"name": "normalizeMediaType", "description": "Infers media type ('manga' or 'anime') from catalog item 'type' field."}, {"name": "withTimeout", "description": "Utility to add a timeout to async operations, preventing hanging."}, {"name": "AppProvider", "description": "Main React component providing global app state, including user session, ratings, lists, and sign-out logic."}, {"name": "setRating", "description": "Sets and persists a media rating, with optimistic UI updates and rollback on failure."}, {"name": "addToList", "description": "Adds a media item to a specified list, updating local state after server confirmation."}, {"name": "removeFromList", "description": "Removes a media item from a specified list, updating local state after server confirmation."}, {"name": "signOutAndNavigate", "description": "Performs a unified sign-out process, with timeout, local state cleanup, optional navigation, and toast notifications."}], "calls": ["getSupabase", "getCurrentSession", "RatingsService.loadAll", "ListsService.loadList", "ListsService.add", "ListsService.remove", "withTimeout", "setUser", "setRatings", "setLists", "navigate"], "search-terms": ["React context", "sign-out logic", "user session management", "ratings persistence", "lists management", "AppProvider", "useAppContext", "manga-anime tracker"], "state": 2, "file_id": 15, "knowledge_revision": 262, "git_revision": "013958c3839e7bd81946e2127686dd2b75f84729", "revision_history": [{"33": ""}, {"67": "fc7765b72c2626febba7a708fd6500363cff79b7"}, {"116": "3d1e11a45db83364aa2658e61d900eb0df9549f7"}, {"117": "3d1e11a45db83364aa2658e61d900eb0df9549f7"}, {"173": "dfe56c4a10e003bc049a0e5e197893cb2cc2556f"}, {"205": "61e897931491cf1a2a39802578e0f3312458cac8"}, {"221": "faa9c17ce808295915d62e9b031c370ef576a7e0"}, {"225": "bf34fbf256f98384a884426468553e30d977547a"}, {"262": "013958c3839e7bd81946e2127686dd2b75f84729"}], "ctags": [], "filename": "koma_corner_frontend/src/context/AppContext.jsx", "format-version": 4, "code-base-name": "https://github.com/kavia-common/manga-and-anime-tracker-40880-41074.git:kavia-main"}