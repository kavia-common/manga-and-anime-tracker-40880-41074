{"is_source_file": true, "format": "JavaScript (JSX)", "description": "This file defines a React context component (AppContext) that manages global application state including user session, ratings, and lists. It provides hooks and functions for authentication, rating and list management, and handles side effects related to user sign-in/out, session checking, and integration with Supabase. It also includes utility functions like media type normalization and async timeout handling.", "external_files": ["../supabaseClient", "../services/catalog", "../services/supabaseData", "../components/Toast"], "external_methods": ["getSupabase", "getEnvWarning", "getCurrentSession", "RatingsService.loadAll", "RatingsService.upsert", "ListsService.loadList", "ListsService.add", "ListsService.remove"], "published": ["AppContext", "useAppContext", "AppProvider"], "classes": [], "methods": [{"name": "useAppContext()", "description": "Hook to access the application context values.", "scope": "", "scopeKind": ""}, {"name": "normalizeMediaType(type)", "description": "Infers media type ('manga' or 'anime') from catalog item 'type' field.", "scope": "", "scopeKind": ""}, {"name": "withTimeout(promise, ms = 4000)", "description": "Wraps a promise with a timeout, rejecting if not resolved within specified milliseconds.", "scope": "", "scopeKind": ""}, {"name": "AppProvider({ children })", "description": "React component providing global app state including user session, ratings, lists, and sign-out functionality.", "scope": "", "scopeKind": ""}, {"name": "setRating", "description": "Updates and persists rating for a media item, using optimistic UI updates."}, {"name": "addToList", "description": "Adds a media item to a specified list with optimistic local cache update."}, {"name": "removeFromList", "description": "Removes a media item from a specified list with optimistic cache update."}, {"name": "signOutAndNavigate", "description": "Handles user sign-out with timeout, local state clearing, optional navigation, and toast notifications."}], "calls": ["getSupabase", "getEnvWarning", "getCurrentSession", "RatingsService.loadAll", "RatingsService.upsert", "ListsService.loadList", "ListsService.add", "ListsService.remove", "withTimeout"], "search-terms": ["React context", "session management", "user ratings", "list management", "Supabase auth", "sign out", "media type normalization", "AppProvider", "useAppContext"], "state": 2, "file_id": 15, "knowledge_revision": 205, "git_revision": "61e897931491cf1a2a39802578e0f3312458cac8", "revision_history": [{"33": ""}, {"67": "fc7765b72c2626febba7a708fd6500363cff79b7"}, {"116": "3d1e11a45db83364aa2658e61d900eb0df9549f7"}, {"117": "3d1e11a45db83364aa2658e61d900eb0df9549f7"}, {"173": "dfe56c4a10e003bc049a0e5e197893cb2cc2556f"}, {"205": "61e897931491cf1a2a39802578e0f3312458cac8"}], "ctags": [{"_type": "tag", "name": "AppContext", "path": "/home/kavia/workspace/code-generation/manga-and-anime-tracker-40880-41074/koma_corner_frontend/src/context/AppContext.jsx", "pattern": "/^export const AppContext = createContext(null);$/", "language": "JavaScript", "kind": "constant"}, {"_type": "tag", "name": "AppProvider", "path": "/home/kavia/workspace/code-generation/manga-and-anime-tracker-40880-41074/koma_corner_frontend/src/context/AppContext.jsx", "pattern": "/^export function AppProvider({ children }) {$/", "language": "JavaScript", "kind": "function", "signature": "({ children })"}, {"_type": "tag", "name": "current", "path": "/home/kavia/workspace/code-generation/manga-and-anime-tracker-40880-41074/koma_corner_frontend/src/context/AppContext.jsx", "pattern": "/^const inFlightAbortRef = { current: false };$/", "language": "JavaScript", "kind": "property", "scope": "inFlightAbortRef", "scopeKind": "class"}, {"_type": "tag", "name": "envWarning", "path": "/home/kavia/workspace/code-generation/manga-and-anime-tracker-40880-41074/koma_corner_frontend/src/context/AppContext.jsx", "pattern": "/^    envWarning: getEnvWarning(),$/", "language": "JavaScript", "kind": "property", "scope": "AppProvider.value", "scopeKind": "class"}, {"_type": "tag", "name": "inFlightAbortRef", "path": "/home/kavia/workspace/code-generation/manga-and-anime-tracker-40880-41074/koma_corner_frontend/src/context/AppContext.jsx", "pattern": "/^const inFlightAbortRef = { current: false };$/", "language": "JavaScript", "kind": "class"}, {"_type": "tag", "name": "list_name", "path": "/home/kavia/workspace/code-generation/manga-and-anime-tracker-40880-41074/koma_corner_frontend/src/context/AppContext.jsx", "pattern": "/^      list_name,$/", "language": "JavaScript", "kind": "field", "scope": "AppProvider.payload", "scopeKind": "class"}, {"_type": "tag", "name": "media_id", "path": "/home/kavia/workspace/code-generation/manga-and-anime-tracker-40880-41074/koma_corner_frontend/src/context/AppContext.jsx", "pattern": "/^      media_id: String(media.id),$/", "language": "JavaScript", "kind": "property", "scope": "AppProvider.payload", "scopeKind": "class"}, {"_type": "tag", "name": "media_type", "path": "/home/kavia/workspace/code-generation/manga-and-anime-tracker-40880-41074/koma_corner_frontend/src/context/AppContext.jsx", "pattern": "/^      media_type: normalizeMediaType(media.type),$/", "language": "JavaScript", "kind": "property", "scope": "AppProvider.payload", "scopeKind": "class"}, {"_type": "tag", "name": "normalizeMediaType", "path": "/home/kavia/workspace/code-generation/manga-and-anime-tracker-40880-41074/koma_corner_frontend/src/context/AppContext.jsx", "pattern": "/^function normalizeMediaType(type) {$/", "language": "JavaScript", "kind": "function", "signature": "(type)"}, {"_type": "tag", "name": "payload", "path": "/home/kavia/workspace/code-generation/manga-and-anime-tracker-40880-41074/koma_corner_frontend/src/context/AppContext.jsx", "pattern": "/^    const payload = {$/", "language": "JavaScript", "kind": "class", "scope": "AppProvider", "scopeKind": "class"}, {"_type": "tag", "name": "sessionChecked", "path": "/home/kavia/workspace/code-generation/manga-and-anime-tracker-40880-41074/koma_corner_frontend/src/context/AppContext.jsx", "pattern": "/^    sessionChecked,$/", "language": "JavaScript", "kind": "field", "scope": "AppProvider.value", "scopeKind": "class"}, {"_type": "tag", "name": "useAppContext", "path": "/home/kavia/workspace/code-generation/manga-and-anime-tracker-40880-41074/koma_corner_frontend/src/context/AppContext.jsx", "pattern": "/^export function useAppContext() {$/", "language": "JavaScript", "kind": "function", "signature": "()"}, {"_type": "tag", "name": "value", "path": "/home/kavia/workspace/code-generation/manga-and-anime-tracker-40880-41074/koma_corner_frontend/src/context/AppContext.jsx", "pattern": "/^    <AppContext.Provider value={value}>$/", "language": "JavaScript", "kind": "field", "scope": "Provider", "scopeKind": "class"}, {"_type": "tag", "name": "value", "path": "/home/kavia/workspace/code-generation/manga-and-anime-tracker-40880-41074/koma_corner_frontend/src/context/AppContext.jsx", "pattern": "/^  const value = {$/", "language": "JavaScript", "kind": "class", "scope": "AppProvider", "scopeKind": "class"}, {"_type": "tag", "name": "withTimeout", "path": "/home/kavia/workspace/code-generation/manga-and-anime-tracker-40880-41074/koma_corner_frontend/src/context/AppContext.jsx", "pattern": "/^async function withTimeout(promise, ms = 4000) {$/", "language": "JavaScript", "kind": "function", "signature": "(promise, ms = 4000)"}], "hash": "bf7ca3c5800c80a0e0bcb56d53bb0c9e", "format-version": 4, "code-base-name": "koma_corner_frontend", "filename": "koma_corner_frontend/src/context/AppContext.jsx", "fields": [{"name": "const inFlightAbortRef = { current: false };", "scope": "inFlightAbortRef", "scopeKind": "class", "description": "unavailable"}, {"name": "envWarning: getEnvWarning(),", "scope": "AppProvider.value", "scopeKind": "class", "description": "unavailable"}, {"name": "list_name,", "scope": "AppProvider.payload", "scopeKind": "class", "description": "unavailable"}, {"name": "media_id: String(media.id),", "scope": "AppProvider.payload", "scopeKind": "class", "description": "unavailable"}, {"name": "media_type: normalizeMediaType(media.type),", "scope": "AppProvider.payload", "scopeKind": "class", "description": "unavailable"}, {"name": "sessionChecked,", "scope": "AppProvider.value", "scopeKind": "class", "description": "unavailable"}, {"name": "<AppContext.Provider value={value}>", "scope": "Provider", "scopeKind": "class", "description": "unavailable"}]}